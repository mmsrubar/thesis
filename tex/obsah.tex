%=========================================================================
% (c) Michal Bidlo, Bohuslav Køena, 2008

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 1. Úvod
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Úvod}
\section{odstavec - co od ètenáøe oèekávám}
\begin{itemize}
	\item základní znalost adresáøù a protokolu LDAP
\end{itemize}

\section{poslední odstavec - èím se tato práce nezabývá}
\begin{itemize}
	\item není to tutorial ani dokumentace k sssd, ipa nebo sudo
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Málo textu?}
\begin{itemize}
	\item popi¹ jak se vytváøejí defaults v sudoers, v LDAPu a na IPA
\end{itemize}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 2. Správa u¾ivatelských práv v doménì
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Správa u¾ivatelských práv v doménì}
Sepi¹ vice mo¾ností jakými je mo¾no delegovat práva a potom napi¹, ¾e v
následujícím textu se bude¹ zabývat právì SUDO+SSSD+IPA proto¾e je to roz¹íøené
mezi u¾ivateli RHELu.  Jestli¾e máme velký server a vice adminù starající se o
vice slu¾eb, tak nechceme ka¾dému dát heslo roota, ale radìji by jsme chtìli mít
mo¾nost delegovat urèitá prává. Tak stejnì u¾ivatelù by se sem tam hodily vy¹¹í
práva

\begin{itemize}
	\item tato kapitole bude takový popis toho jak je mo¾né spravovat u¾ivatelská
		práva pomocí suda v doménì
	\item konkrétnì s vyu¾itím tìchto technologii (SUDO+IPA+SSSD)
	\item jaké problémy to pøiná¹í a jak je tyto technologie øe¹í (SUDO+IPA+SSSD)
\end{itemize}
%-------------------------------------------------------------------------------
\section{SUDO}
\begin{itemize}
	\item co to je a co nám to umo¾òuje dìlat
	\item jak to pracuje
	\item co to jsou sudo pravidla
	\item syntax sudo pravidel + obrázek s pøíkladem (pøíklad stejného pravidla
		jak by vypadalo v ldapu a pak v IPA)
\end{itemize}

\subsection{Distribuce sudo pravidel}
\begin{itemize}
	\item ¹íøení sudo pravidel mezi více poèítaèù je problém (obrázek: jeden administrator má nastarost spoustu strojù, kdy ka¾dý má vlasní sudoers soubor pravidel)
	\item mo¾ná øe¹ení toho problému
	\item mnoho spoleèností dnes LDAP pou¾ívá a celkem se hodí pro ulo¾ení sudo pravidel
\end{itemize}

\subsection{distribuce pravidel s pomocí LDAPu}
\begin{itemize}
	\item rozdíl mezi lokalním sudoers a sudoers v LDAPu (LDAP negarantuje poøadí
		v jakém vrací záznamy ani atributy)
	\item stejný pøíklad sudo pravidla jak by vypadalo v LDAPu
\end{itemize}
%-------------------------------------------------------------------------------
\section{FreeIPA}
\begin{itemize}
	\item	musí¹ vymezit oblast: IPA umí 100 vìcí, ale nás bude v rámci této práce zajímat pouze sudo pravidla
	\item	co to je a krátce co to v¹echno umí
	\item	popsat IPA SUDO Schéma a srovnat ho s LDAP SUDO Schématem
	\item	nezmiòovat detaily compat plugin maximálnì øíct, ¾e sssd je v tom
		nativním IPA schématu neumí zpracovat a odkzáat se na
		\ref{ch:sssd:sec:ipa_provider}
	\begin{itemize}
		\item ka¾dé záznam i kontejner v sudo kontejneru má operaèní atribut entryUSN, vèetnì sudo kontejneru samotného
	\end{itemize}

\subsubsection{problem spojené s tím, kdy¾ mám sudoers v LDAPu}
	\begin{itemize}
		\item problem s pøekrýváním u¾ivatelù
		\item schema je dané a nedá se mìnit
		\item nepropojenost u¾ivatelù s pravidly (pøíklad s tím mazáním pravidel)
	\end{itemize}
\end{itemize}

\subsubsection{výhody kdy¾ mám sudoers na IPA}
\begin{itemize}
	\item webgui pro správu pravidel (sudo+ldap => manuální správa pravidel pøes konfiguraèní soubory)
	\item granularita
	\item	pøiklad sudo pravidla v novém IPA formatu (stejný pøíklad jako v sekci sudo)
	\item propojení pravidel s identitami (pokud sma¾u u¾ivatele tak u¾ jeho
		pravidlo nepotøebuji, na IPA se sma¾e, ale v èistém LDAPu by zùstalo)
	\item na IPA mù¾u zakazovat a povolovat pravidla (v LDAPu tam buï je a bude
		pou¾ito nebo ho musím smazat)
	\item ty dvì futury z dokumentace (hostgroups)
\end{itemize}
%-------------------------------------------------------------------------------
\section{SSSD z u¾ivatelského hlediska}
\begin{itemize}
	\item v¹e o SSSD z u¾ivatelského hlediska, implementaèní detaily v kapitole
		\ref{ch:sssd}
	\item obrázek (user -> sudo -> SSSD -> IPA)
	\item co to je a krátce co to v¹echno umí
	\item vymezení oblast, kterou se tato práce bude zabývat
	\item da se pøipojit k více doménám zároveò a tedy prohledávám více search
		bases (dát to a¾ do kapitoly SSSD?)
	\item nevýhody, které má øe¹ení stahování pravidel pøes sudo ldap plugin
	\begin{itemize}
		\item sí»
		\item cachování
	\end{itemize}
\end{itemize}

\subsection{Aktualizace sudo pravidel v cache pamìti}
SSSD provádí následující tøi typy aktualizací sudo pravidel:

\subsubsection{Smart refresh}

\subsubsection{Úplná aktualizace}
Provede smazání v¹ech pravidel z cache pamìti a sta¾ení v¹ech pravidel ze serveru.
Tento typ aktualizace se provádí pouze v nìkterých pøípadech, proto¾e pøi velkém mno¾ství
pravidel generuje velký sí»ový provoz. Provádí se tedy pouze pøi spu¹tìní SSSD nebo
pøi detekci zmìny pravidel na serveru.

\subsubsection{Aktualizace pravidel}
Je provedena pøi ka¾dém spu¹tiní SUDO. Zajistí aby u¾ivatel nedostal vìt¹í
oprávnìní ne¾ je definováno. Tento typ aktualizace stáhne ze serveru pouze
pravidla, která expirovala\footnote{Èas po kterém pravidla v cache pamìti exspirují je mo¾no
nastavit v \texttt{sssd.conf} pomocí volby \texttt{entry\_cache\_sudo\_timeout}, viz.
\emph{man sssd.conf}}. Jestli¾e se nìkteré pravidlo na serveru
nenachází, indikuje to zmìnu na serveru a je provedena úplna aktualizace
pravidel.
\newline
\\
Implementace v¹ech tøí typù aktualizací je popsána v sekcích 
\ref{ch:sssd:sec:ldap_provider:smart_refresh_implementation},
\ref{ch:sssd:sec:ldap_provider:rules_refresh_implementation} a
\ref{ch:sssd:sec:ldap_provider:full_refresh_implementation}.
  
\subsection{Konfiguraèní volby}\label{ch:theory:sec:sssd:sssd_sudo_options}

\subsubsection{Modifikace LDAP schématu}\label{ch:theory:sec:sssd:sssd_ldap_options}
\begin{itemize}
	\item pokud chci mít sudo v LDAPu v sudo schématu, pak atributy v LDAPu musí
		mít jasnì specifikované jména (\texttt{sudoHost, sudoCmd}, \dots) u SSSD to lze
		ovlivnit pomocí voleb \texttt{ldap\_sudorule\_object\_class,
		ldap\_sudorule\_name, \dots}\footnote{Pro bli¾¹í informace hledejte
		\texttt{ldap\_sudorule\_*} v manuálové stránce \texttt{man sssd-ldap}}.
		Implementaèní detaily je mo¾né nalézt v sekci 
		\ref{ch:sssd:sec:ldap_provider:native_sudorule_map}.
\end{itemize}
	
\begin{itemize}
	\item sssd volby pro sssd.conf
	\begin{itemize}
		\item ldap\_sudo\_use\_host\_filter
	\end{itemize}
\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 3. SSSD
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{SSSD}\label{ch:sssd}
\begin{itemize}
	\item popisuje sssd ze sudo prespektivy (a postupnì jde do detailu 1. high
		level overview -> a pak zamìøení na respondery a providery
	\item tato kapitola popisuje vnitøní architekturu SSSD se zamìøením na SUDO
		respondera a providera (spí¹e jen providera ne?)
	\item popsat ten základ co to je monitor, backendy, provideri, responderi
	\item popisuje základní koncepty knihoven talloc a tevent na kterých SSSD staví
\end{itemize}
%-------------------------------------------------------------------------------
\section{Talloc}
\begin{itemize}
	\item	základní concept hierarchického alokátoru
	\item	nahrazuje malloc
\end{itemize}

\section {Tevent}
\begin{itemize}
	\item	událostmi øízené paradigm programování
	\item	vysvìtlit základní concept událostí, requests, subrequest, asynchronní funkce
	\item	pou¾ívá talloc
	\item	zmínit ¾e obaluje DBus a OpenLDAP (SDAP)
\end{itemize}

\section {Dereference u LDAPv3}

\section {Architektura SSSD}
\begin{itemize}
	\item	z jakých komponent se SSSD skládá (monitor, backends, responders, provideres)
	\item	schéma architektury
\end{itemize}

\section {Tok dat}
\begin{itemize}
	\item	tok dat do SUDO -> SUDO Responder -> Backend -> LDAP Provider -> IPA a zpìt
	\item big diagram - nerozkrývat detaily respondera a providera
\end{itemize}

\section{Mapování konfiguraèních voleb a atributù}
\label{maps}
Mapy se pou¾ívají k mapování hodnot
voleb\footnote{viz. sekce \ref{ch:theory:sec:sssd:sssd_sudo_options}} z
konfiguraèního souboru SSSD\footnote{Ve výchozím nastavení se nachází v
	\texttt{/etc/sssd/sssd.conf}, ale je mo¾no jej také specifikovat pomocí
	pøepínaèe \texttt{-c}, viz.  \texttt{man sssd}}, pro výbìr atributù pøi
	sestavování LDAP dotazu a pro definování jmen atributù pod kterými budou
	výsledky dotazù ulo¾eny v \texttt{sysdb}. 

Výchozí mapy jsou definovány v souboru \texttt{providers/ldap/ldap\_opts.h}. Zde
je také definována výchozí mapa, kterou LDAP SUDO Provider pou¾ívá pøi stahování
SUDO pravidel z LDAP serveru.  nacházejí se zde i ostatní výchozí mapy pou¾ívané
ve spojení s LDAP servery. Mapy pou¾ívané pøi komunikace s IPA serverem se
nacházejí v souboru \texttt{providers/ipa/ipa\_opts.h}.

Vìt¹ina map je definována jako pole struktur \texttt{sdap\_attr\_map}.

\lstset{language=c}
\begin{lstlisting}
struct sdap_attr_map {
    const char *opt_name;
    const char *def_name;
    const char *sys_name;
    char *name;
};
\end{lstlisting}

\subsection{Vytvoøení mapy}
Mapa se vytváøí pomocí funkce \texttt{sdap\_get\_map}. Jako jeden z parametrù je
nutné specifikovat výchozí mapu, ze které bude mapa vytvoøena. V promìnných
\texttt{opt\_name} jsou ulo¾eny hodnoty voleb z konfiguraèního
souboru\footnote{Hodnoty tìchto voleb jsou ulo¾eny v kontextu monitoru.}, jejich¾
hodnoty se ulo¾í do promìnných \texttt{name}.  Jestli¾e se daná volba v
konfiguraèním souboru nenachází, pak je pro promìnnou \texttt{name} pou¾ita
výchozí hodnota tj. hodnota prommìné \texttt{def\_name}, která bude
specifikována ve výchozí mapì.  Vytvoøení mapy znázoròuje schéma
\ref{crate_map}.

\begin{figure}[ht!]
\centering
\includegraphics[width=120mm]{fig/sssd/create_map.png}
\caption{Vytvoøení mapy}
\label{crate_map}
\end{figure}

\subsection{Pou¾ití map}
Hodnoty promìnných \texttt{name} jsou pou¾ity pøi vytváøení atributù, které se
mají vyhledat pøi LDAP dotazech. Promìnná \texttt{sys\_name} je pou¾ita pro jméno
atributu, pod kterým bude ulo¾ena hodnota, která se nachází na serveru pod
hledaným atributem, v \texttt{sysdb}.  Vyu¾ití mapy ve spojení s LDAP dotazy znázoròuje
schéma \ref{map_usage}.
\begin{figure}[ht!]
\centering
\includegraphics[width=150mm]{fig/sssd/map_usage.png}
\caption{Pou¾ití map}
\label{map_usage}
\end{figure}


\section {Backed}
\begin{itemize}
	\item sudo search base
	\begin{itemize}
		\item kde se nastavuje
		\item pro ka¾dou doménu mù¾e být jiná -> proto je tam to search bases pole
	\end{itemize}
	\item kdy se nastavuje sudorule map, podrobnìji o mapì v
		sekci\ref{ch:sssd:sec:ldap_provider:native_sudorule_map}
	\item jak se zavadìjí provideøi
	\item jak se spou¹tìjí respondeøi (alias services)
	\item	monitor creates backend for every domain
\end{itemize}

\section {SUDO Responder}
\begin{itemize}
	\item	zamìøit se na vìci, které se budou mìnit?
	\item dát to a¾ po ldap provideru?
\end{itemize}

%-------------------------------------------------------------------------------
\section {LDAP SUDO Provider}
\begin{itemize}
	\item	Nejprve popsat LDAP provider (a nezmiòovat ipa sudo providera) a a¾ v
		sekci o ipa sudo providerovi øíct, ¾e v podstatnì není a souèasná
		implementace je jen wrapper pro LDAP SUDO Proivder pou¾ívající compat plugin, ou=SUDOers kontejnér)
	\item	popsat nejprve high level schéma a pak se jednotlivými bloky (inicializace, full refresh, refresh, zabývat podrobnìji
	\item	nastavení search base a search bases array
\end{itemize}

\subsection {Inicializace}\label{ldap_sudo_provider_initialization}
\begin{itemize}
	\item jak to jde po sobì
	\begin{itemize}
		\item vytváøí se hlavní sudo\_ctx, který je zároveò privátnimi daty LDAP SUDO
			Providera
		\item	nastavuje se sudo\_handler pro SUDO Respondera
		\item	kontroluje se zda je nastavena sudo\_search\_base (pokud neni
			nastavena v sssd.conf, tak se nastavi na \emph{SUDOers} pøi inicializaci
			\emph{id\_provideru} v \emph{ipa\_common.c}
		\item vytvoøí se sdap\_search\_base struktura pro danou sudo\_search\_filter
			(je tam specifikovana ta scope a filter)
	\end{itemize}
\end{itemize}


Vytváøí se zde sudorule mapa. Jako výchozí mapa je pou¾ita
\texttt{native\_sudorule\_map} a pøi vytváøení se také zohledòují volby (viz.
sekce \ref{ch:theory:sec:sssd:sssd_ldap_options}) zadané v konfiguraèním
souboru SSSD. Ukazatel na
vytvoøenou mapu je ulo¾en v \texttt{id\_ctx}\footnote{Kontext providera identit (angl.
Context of Identity Provider}. Vytvoøení a pou¾ití map je blí¾e popsáno v sekci \ref{maps}.

\begin{itemize}
	\item	detailní popis se schématy
	\item	vytvoøení mapy (detailní popis pozdìji)
	\item	nastavení plánování refresh
	\item	zmínit, ¾e se pøi ka¾dém spu¹tìní provádí FULL REFRESH
\end{itemize}


\subsection {Pánování refreshes}
\begin{itemize}
	\item	jakým zpùsobem jsou jednotlivé resfresh plánovany
	\item podrobnìji se popsat v sekci ní¾e
\end{itemize}

\subsection {Full refresh (pro ka¾dý typ vlastní sub
sekci?)}\label{ch:sssd:sec:ldap_provider:full_refresh_implementation}
\begin{itemize}
	\item	obecné informace v user sekci u SSSD v kapitole 2
	\item	jak se vyvolávají
	\item	jak se plánují 
	\item	jak se dají èasy ovlivnit v sssd.conf
	\item	jaké LDAP filtry pou¾ívají
	\item	zmínit ¾e v¹echny vyu¾ívají to asynchronní provádìní od
		sdap\_sudo\_refresh (v providers/ldap/sdap\_async\_sudo.c)
\end{itemize}
\subsection {Smart refresh}\label{ch:sssd:sec:ldap_provider:smart_refresh_implementation}
\subsection {Rules refresh}\label{ch:sssd:sec:ldap_provider:rules_refresh_implementation}

\subsection {Asychnronní sta¾ení a ulo¾ení pravidel}
\begin{itemize}
	\item	hlavní motor LDAP SUDO Provideru, který vyu¾ívají v¹echny typy refresh
	\item	detailní popis se schématy
\end{itemize}

\subsection {LDAP SUDO Handler}
\begin{itemize}
	\item	co to je
	\item	jak pøes nìj SUDO RESPONDER komunikuje s IPA
	\item	co po nìm mù¾e sudo responder v¹echno chtít
\end{itemize}
%-------------------------------------------------------------------------------
\section {IPA SUDO Provider}\label{ch:sssd:sec:ipa_provider}
\begin{figure}[ht!]
\centering
\includegraphics[width=90mm]{fig/sssd/ipa_sudo_provider_wrapper.jpg}
\caption{A simple caption}
\label{overflow}
\end{figure}

\begin{itemize}
	\item popsat, ¾e souèasná implementace je jen wrapper LDAP SUDO Providera bez
		¾ádné funkcionality navíc
	\item	kdy¾ stahuju pravidla normálnì z LDAP adresáøe tak se pou¾ije tento provider, ale kdy¾ je chci stahovat z IPA, tak se na IPA serveru musí ty pravidla pøekládáat pøes kompat plugin do SUDOers kontejnéru a to pøiná¹í re¾ii, proto¾e musíme pøekládávat v¹echny pravidla
	\item	SSSD neumí zpracovat pravidla IPA formátu
	\item	momentálnì ¾ádný nativní IPA SUDO Provider neexistuje a IPA SUDO Provider vyu¾ívá LDAP SUDO Provider
	\item	neumo¾òuje to vyu¾ít v¹ech vlastností nového IPA SUDO schemata (ipaSudoOpt)
	\item	pokud se export pravidel pøesune do SSSD, tak se nemusí exportovat v¹echny pravidla, ale pouze ty aplikovatelná na konkrétního hosta
 
	\item	popsat funkci compat palaginu + obrázek
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 4. Nativní IPA SUDO Provider
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Nativní IPA SUDO Provider}
\begin{itemize}
	\item	tato kapitoval se zabývá diskusí nad návrhem nativního IPA SUDO
		provideru, jeho implementaci a zpùsob testování
	\item v podstatì to bude mít stejné kapitoly jako u LDAP SUDO provideru a v
		ka¾dé kapitole popí¹u co se musí zmìnit co se musí dìlat jinak atd
\end{itemize}


\section{Návrh}
\begin{itemize}
	\item	stejné schéma jako u high level overview of LDAP SUDO provider a
		èervenì v nìm zaznaèit nový koncept a lehce popsat
\end{itemize}


\subsection{Inicializace}
\begin{itemize}
	\item	vlastní inicializace nebo vyu¾iju tu od LDAPu?
	\item vytvarim vlastni mapu
\end{itemize}

\subsection {Pánování refreshes}

\subsection {Full, Smart and Rules refresh (pro ka¾dý typ vlastní sub sekci?)}
\begin{itemize}
	\item nové LDAP search filtry a proè jsem je vybral
	\item (refer to LDAP filters in RFC! https://tools.ietf.org/html/rfc2254\#ref-1)
	\item Proè se musím dotazovat dvakrát abych stáhnul v¹echny potøebné informace
	\item Jak bylo zmínìno v kapitole 2 sekce Freeipa, informace o sudo pravidlech
		jsou ulo¾ena ve tøech adresáøových kontejnerech. 
	\item popsat zpùsoby nad kterými si uva¾oval
\end{itemize}

\subsection {Asychnronní sta¾ení a ulo¾ení pravidel}

\subsection {Nativní mapa sudo pravidel}

\subsection {LDAP SUDO Handler}

\section{Implementace}

\section{Testování}
\begin{itemize}
	\item bench marky jestli je to rychlej¹í ne¾ LDAP SUDO Provider?
	\item performance testy, od lidí, kteøí pou¾ívají IPA s velkou databází
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 5. Závìr
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Zhodnocení}
\begin{itemize}
	\item 1. ostavec
	\begin{itemize}
		\item	co se mi podaøilo naimplementovat a otestovat
		\item	co na to komunita sssd
		\item	vìci nad rámec zadání jako patche nebo dokumentace, která neexistovala
	\end{itemize}
	\item 2. odstavec
	\begin{itemize}
		\item dal¹í vìci na kterých bych se dalo zapracovat
	\end{itemize}
\end{itemize}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Úvod}
Abychom mohli napsat odborný text jasnì a~srozumitelnì, musíme splnit nìkolik základních pøedpokladù:
\begin{itemize}
\item Musíme mít co øíci,
\item musíme vìdìt, komu to chceme øíci,
\item musíme si dokonale promyslet obsah,
\item musíme psát strukturovanì. 
\end{itemize}

Tyto a dal¹í pokyny jsou dostupné té¾ na ¹kolních internetových stránkách \cite{fitWeb}.

Pøehled základù typografie a tvorby dokumentù s vyu¾itím systému \LaTeX je 
uveden v~\cite{Rybicka}.

\section{Musíme mít co øíci}
Dal¹ím dùle¾itým pøedpokladem dobrého psaní je {\it psát pro nìkoho}. Pí¹eme-li si poznámky sami pro sebe, pí¹eme je jinak ne¾ výzkumnou zprávu, èlánek, diplomovou práci, knihu nebo dopis. Podle pøedpokládaného ètenáøe se rozhodneme pro zpùsob psaní, rozsah informace a~míru detailù.

\section{Musíme vìdìt, komu to chceme øíci}
Dal¹ím dùle¾itým pøedpokladem dobrého psaní je psát pro nìkoho. Pí¹eme-li si poznámky sami pro sebe, pí¹eme je jinak ne¾ výzkumnou zprávu, èlánek, diplomovou práci, knihu nebo dopis. Podle pøedpokládaného ètenáøe se rozhodneme pro zpùsob psaní, rozsah informace a~míru detailù.

\section{Musíme si dokonale promyslet obsah}
Musíme si dokonale promyslet a~sestavit obsah sdìlení a~vytvoøit poøadí, v~jakém chceme ètenáøi své my¹lenky prezentovat. 
Jakmile víme, co chceme øíci a~komu, musíme si rozvrhnout látku. Ideální je takové rozvr¾ení, které tvoøí logicky pøesný a~psychologicky stravitelný celek, ve kterém je pro v¹echno místo a~jeho¾ jednotlivé èásti do sebe pøesnì zapadají. Jsou jasné v¹echny souvislosti a~je zøejmé, co kam patøí.

Abychom tohoto cíle dosáhli, musíme peèlivì organizovat látku. Rozhodneme, co budou hlavní kapitoly, co podkapitoly a~jaké jsou mezi nimi vztahy. Diagramem takové organizace je graf, který je velmi podobný stromu, ale ne øetìzci. Pøi organizaci látky je stejnì dùle¾itá otázka, co do osnovy zahrnout, jako otázka, co z~ní vypustit. Pøíli¹ mnoho podrobností mù¾e ètenáøe právì tak odradit jako ¾ádné detaily.

Výsledkem této etapy je osnova textu, kterou tvoøí sled hlavních my¹lenek a~mezi nì zaøazené detaily.

\section{Musíme psát strukturovanì} 
Musíme zaèít psát strukturovanì a~souèasnì pracujeme na co nejsrozumitelnìj¹í formì, vèetnì dobrého slohu a~dokonalého znaèení. 
Máme-li tedy my¹lenku, pøedstavu o~budoucím ètenáøi, cíl a~osnovu textu, mù¾eme zaèít psát. Pøi psaní prvního konceptu se sna¾íme zaznamenat v¹echny své my¹lenky a~názory vztahující se k~jednotlivým kapitolám a~podkapitolám. Ka¾dou my¹lenku musíme vysvìtlit, popsat a~prokázat. Hlavní my¹lenku má v¾dy vyjadøovat hlavní vìta a~nikoliv vìta vedlej¹í.

I k~procesu psaní textu pøistupujeme strukturovanì. Souèasnì s~tím, jak si ujasòujeme strukturu písemné práce, vytváøíme kostru textu, kterou postupnì doplòujeme. Vyu¾íváme ty prostøedky DTP programu, které podporují strukturovanou stavbu textu (pøeddefinované typy pro nadpisy a~bloky textu). 


\chapter{Nìkolik formálních pravidel}
Na¹ím cílem je vytvoøit jasný a~srozumitelný text. Vyjadøujeme se proto pøesnì, pí¹eme dobrou èe¹tinou (nebo zpravidla angliètinou) a~dobrým slohem podle obecnì pøijatých zvyklostí. Text má upravit ètenáøi cestu k~rychlému pochopení problému, pøedvídat jeho obtí¾e a~pøedcházet jim. Dobrý sloh pøedpokládá bezvadnou gramatiku, správnou interpunkci a~vhodnou volbu slov. Sna¾íme se, aby ná¹ text nepùsobil pøíli¹ jednotvárnì pou¾íváním malého výbìru slov a~tím, ¾e nìkterá zvlá¹» oblíbená slova pou¾íváme pøíli¹ èasto. Pokud pou¾íváme cizích slov, je samozøejmým pøedpokladem, ¾e známe jejich pøesný význam. Ale i~èeských slov musíme pou¾ívat ve správném smyslu. Napø. platí jistá pravidla pøi pou¾ívání slova {\it zøejmì}. Je {\it zøejmé} opravdu zøejmé? A~pøesvìdèili jsme se, zda to, co je {\it zøejmé} opravdu platí? Pozor bychom si mìli dát i~na pøíli¹ èasté pou¾ívání zvratného se. Napøíklad obratu {\it dokázalo se}, ¾e... zásadnì nepou¾íváme. Není ¹patné pou¾ívat autorského {\it my}, tím pøedpokládáme, ¾e nìco øe¹íme, nebo napøíklad zobecòujeme spolu se ètenáøem. V~kvalifikaèních pracích pou¾ijeme autorského {\it já} (napøíklad kdy¾ vymezujeme podíl vlastní práce vùèi pøevzatému textu), ale v~bì¾ném textu se nadmìrné pou¾ívání první osoby jednotného èísla nedoporuèuje.

Za peèlivý výbìr stojí i~symbolika, kterou pou¾íváme ke {\it znaèení}. Máme tím na mysli volbu zkratek a~symbolù pou¾ívaných napøíklad pro vyjádøení typù souèástek, pro oznaèení hlavních èinností programu, pro pojmenování ovládacích kláves na klávesnici, pro pojmenování promìnných v~matematických formulích a~podobnì. Výsti¾né a~dùsledné znaèení mù¾e ètenáøi pøi èetbì textu velmi pomoci. Je vhodné uvést seznam znaèení na zaèátku textu. Nejen ve znaèení, ale i~v~odkazech a~v~celkové tiskové úpravì je dùle¾itá dùslednost.

S tím souvisí i~pojem z~typografie nazývaný {\it vyznaèování}. Zde máme na mysli zpùsob sazby textu pro jeho zvýraznìní. Pro zvolené znaèení by mìl být zvolen i~zpùsob vyznaèování v~textu. Tak napøíklad klávesy mohou být umístìny do obdélníèku, identifikátory ze zdrojového textu mohou být vypisovány {\tt písmem typu psací stroj} a~podobnì.

Uvádíme-li nìkterá fakta, neskrýváme jejich pùvod a~ná¹ vztah k~nim. Kdy¾ nìco tvrdíme, v¾dycky výslovnì uvedeme, co z~toho bylo dokázáno, co teprve bude dokázáno v~na¹em textu a~co pøebíráme z~literatury s~uvedením odkazu na pøíslu¹ný zdroj. V~tomto smìru nenecháváme ètenáøe nikdy na pochybách, zda jde o~my¹lenku na¹i nebo pøevzatou z~literatury.

Nikdy neplýtváme ètenáøovým èasem výkladem triviálních a~nepodstatných informací. Neuvádíme rovnì¾ nìkolikrát toté¾ jen jinými slovy. Pøi pozdìj¹ích úpravách textu se nám mù¾e nìkterá døíve napsaná pasá¾ jevit jako zbyteènì podrobná nebo dokonce zcela zbyteèná. Vypu¹tìní takové pasá¾e nebo alespoò její zestruènìní pøispìje k~lep¹í èitelnosti práce! Tento krok ale vy¾aduje odvahu zahodit èas, který jsme jejímu vytvoøení vìnovali. 


\chapter{Nikdy to nebude naprosto dokonalé}
Kdy¾ jsme u¾ napsali v¹e, o~èem jsme pøemý¹leli, udìláme si den nebo dva dny volna a~pak si pøeèteme sami rukopis znovu. Udìláme je¹tì poslední úpravy a~skonèíme. Jsme si vìdomi toho, ¾e v¾dy zùstane nìco nedokonèeno, v¾dy existuje lep¹í zpùsob, jak nìco vysvìtlit, ale ka¾dá etapa úprav musí být koneèná.


\chapter{Typografické a~jazykové zásady}
Pøi tisku odborného textu typu {\it technická zpráva} (anglicky {\it technical report}), ke kterému patøí napøíklad i~text kvalifikaèních prací, se èasto volí formát A4 a~èasto se tiskne pouze po jedné stranì papíru. V~takovém pøípadì volte levý okraj v¹ech stránek o~nìco vìt¹í ne¾ pravý -- v~tomto místì budou papíry svázány a~technologie vazby si tento po¾adavek vynucuje. Pøi vazbì s~pevným høbetem by se levý okraj mìl dìlat o~nìco ¹ir¹í pro tlusté svazky, proto¾e se stránky budou hùøe rozevírat a~levý okraj se tak bude oku ménì odhalovat.

Horní a~spodní okraj volte stejnì veliký, pøípadnì poti¹tìnou èást posuòte mírnì nahoru (horní okraj men¹í ne¾ dolní). Poèítejte s~tím, ¾e pøi vazbì budou okraje mírnì oøíznuty.

Pro sazbu na stránku formátu A4 je vhodné pou¾ívat pro základní text písmo stupnì (velikosti) 11 bodù. Volte ¹íøku sazby 15 a¾ 16 centimetrù a~vý¹ku 22 a¾ 23 centimetrù (vèetnì pøípadných hlavièek a~patièek). Proklad mezi øádky se volí 120 procent stupnì pou¾itého základního písma, co¾ je optimální hodnota pro rychlost ètení souvislého textu. V~pøípadì pou¾ití systému LaTeX ponecháme implicitní nastavení. Pøi psaní kvalifikaèní práce se øiïte pøíslu¹nými závaznými po¾adavky.

Stupeò písma u~nadpisù rùzné úrovnì volíme podle standardních typografických pravidel. 
Pro v¹echny uvedené druhy nadpisù se obvykle pou¾ívá polotuèné nebo tuèné písmo (jednotnì buï v¹ude polotuèné nebo v¹ude tuèné). Proklad se volí tak, aby se následující text bì¾ných odstavcù sázel pokud mo¾no na {\it pevný rejstøík}, to znamená jakoby na linky s~pøedem definovanou a~pevnou rozteèí.

Uspoøádání jednotlivých èástí textu musí být pøehledné a~logické. Je tøeba odli¹it názvy kapitol a~podkapitol -- pí¹eme je malými písmeny kromì velkých zaèáteèních písmen. U~jednotlivých odstavcù textu odsazujeme první øádek odstavce asi o~jeden a¾ dva ètverèíky (v¾dy o~stejnou, pøedem zvolenou hodnotu), tedy pøibli¾nì o~dvì ¹íøky velkého písmene M základního textu. Poslední øádek pøedchozího odstavce a~první øádek následujícího odstavce se v~takovém pøípadì neoddìlují svislou mezerou. Proklad mezi tìmito øádky je stejný jako proklad mezi øádky uvnitø odstavce.

Pøi vkládání obrázkù volte jejich rozmìry tak, aby nepøesáhly oblast, do které se tiskne text (tj. okraje textu ze v¹ech stran). Pro velké obrázky vyèleòte samostatnou stránku. Obrázky nebo tabulky o~rozmìrech vìt¹ích ne¾ A4 umístìte do písemné zprávy formou skládanky v¹ité do pøílohy nebo vlo¾ené do zálo¾ek na zadní desce.

Obrázky i~tabulky musí být poøadovì oèíslovány. Èíslování se volí buï prùbì¾né v~rámci celého textu, nebo -- co¾ bývá praktiètìj¹í -- prùbì¾né v~rámci kapitoly. V~druhém pøípadì se èíslo tabulky nebo obrázku skládá z~èísla kapitoly a~èísla obrázku/tabulky v~rámci kapitoly -- èísla jsou oddìlena teèkou. Èísla podkapitol nemají na èíslování obrázkù a~tabulek ¾ádný vliv.

Tabulky a~obrázky pou¾ívají své vlastní, nezávislé èíselné øady. Z toho vyplývá, ¾e v~odkazech uvnitø textu musíme kromì èísla udat i~informaci o~tom, zda se jedná o~obrázek èi tabulku (napøíklad ``... {\it viz tabulka 2.7} ...''). Dodr¾ování této zásady je ostatnì velmi pøirozené.

Pro odkazy na stránky, na èísla kapitol a~podkapitol, na èísla obrázkù a~tabulek a~v~dal¹ích podobných pøíkladech vyu¾íváme speciálních prostøedkù DTP programu, které zajistí vygenerování správného èísla i~v~pøípadì, ¾e se text posune díky zmìnám samotného textu nebo díky úpravì parametrù sazby. Pøíkladem takového prostøedku v~systému LaTeX je odkaz na èíslo odpovídající umístìní znaèky v~textu, napøíklad návì¹tí ($\backslash${\tt ref\{navesti\}} -- podle umístìní návì¹tí se bude jednat o~èíslo kapitoly, podkapitoly, obrázku, tabulky nebo podobného èíslovaného prvku), na stránku, která obsahuje danou znaèku ($\backslash${\tt pageref\{navesti\}}), nebo na literární odkaz ($\backslash${\tt cite\{identifikator\}}).

Rovnice, na které se budeme v~textu odvolávat, opatøíme poøadovými èísly pøi pravém okraji pøíslu¹ného øádku. Tato poøadová èísla se pí¹í v~kulatých závorkách. Èíslování rovnic mù¾e být prùbì¾né v~textu nebo v~jednotlivých kapitolách.

Jste-li na pochybách pøi sazbì matematického textu, sna¾te se dodr¾et zpùsob sazby definovaný systémem LaTeX. Obsahuje-li va¹e práce velké mno¾ství matematických formulí, doporuèujeme dát pøednost pou¾ití systému LaTeX.

Mezeru nedìláme tam, kde se spojují èíslice s~písmeny v~jedno slovo nebo v~jeden znak -- napøíklad {\it 25krát}.

Èlenicí (interpunkèní) znaménka teèka, èárka, støedník, dvojteèka, otazník a~vykøièník, jako¾ i~uzavírací závorky a~uvozovky se pøimykají k~pøedcházejícímu slovu bez mezery. Mezera se dìlá a¾ za nimi. To se ov¹em netýká desetinné èárky (nebo desetinné teèky). Otevírací závorka a~pøední uvozovky se pøimykají k~následujícímu slovu a~mezera se vynechává pøed nimi -- (takto) a~``takto''.

Pro spojovací a~rozdìlovací èárku a~pomlèku nepou¾íváme stejný znak. Pro pomlèku je vyhrazen jiný znak (del¹í). V~systému TeX (LaTeX) se spojovací èárka zapisuje jako jeden znak ``pomlèka'' (napøíklad ``Brno-mìsto''), pro sázení textu ve smyslu intervalu nebo dvojic, soupeøù a~podobnì se ve zdrojovém textu pou¾ívá dvojice znakù ``pomlèka'' (napøíklad ``zápas Sparta -- Slavie''; ``cena 23--25 korun''), pro výrazné oddìlení èásti vìty, pro výrazné oddìlení vlo¾ené vìty, pro vyjádøení nevyslovené my¹lenky a~v~dal¹ích situacích (viz Pravidla èeského pravopisu) se pou¾ívá nejdel¹í typ pomlèky, která se ve zdrojovém textu zapisuje jako trojice znakù ``pomlèka'' (napøíklad ``Dal¹í pojem --- jakkoliv se mù¾e zdát nevýznamný --- bude neformálnì definován v~následujícím odstavci.''). Pøi sazbì matematického mínus se pøi sazbì pou¾ívá rovnì¾ odli¹ný znak. V~systému TeX je ve zdrojovém textu zapsán jako normální mínus (tj. znak ``pomlèka''). Sazba v~matematickém prostøedí, kdy se vzoreèek uzavírá mezi dolary, zajistí vygenerování správného výstupu.

Lomítko se pí¹e bez mezer. Napøíklad ¹kolní rok 2008/2009.

Pravidla pro psaní zkratek jsou uvedena v~Pravidlech èeského pravopisu \cite{Pravidla}. I~z~jiných dùvodù je vhodné, abyste tuto knihu mìli po ruce. 


\section{Co to je normovaná stránka?}
Pojem {\it normovaná stránka} se vztahuje k~posuzování objemu práce, nikoliv k~poètu vyti¹tìných listù. Z historického hlediska jde o~poèet stránek rukopisu, který se psal psacím strojem na speciální pøedti¹tìné formuláøe pøi dodr¾ení prùmìrné délky øádku 60 znakù a~pøi 30 øádcích na stránku rukopisu. Vzhledem k~zápisu korekturních znaèek se pou¾ívalo øádkování 2 (ob jeden øádek). Tyto údaje (poèet znakù na øádek, poèet øádkù a~proklad mezi nimi) se nijak nevztahují ke koneènému vyti¹tìnému výsledku. Pou¾ívají se pouze pro posouzení rozsahu. Jednou normovanou stránkou se tedy rozumí 60*30 = 1800 znakù. Obrázky zaøazené do textu se zapoèítávají do rozsahu písemné práce odhadem jako mno¾ství textu, které by ve výsledném dokumentu potisklo stejnì velkou plochu.

Orientaèní rozsah práce v~normostranách lze v~programu Microsoft Word zjistit pomocí funkce {\it Poèet slov} v~menu {\it Nástroje}, kdy¾ hodnotu {\it Znaky (vèetnì mezer)} vydìlíte konstantou 1800. Do rozsahu práce se zapoèítává pouze text uvedený v~jádru práce. Èásti jako abstrakt, klíèová slova, prohlá¹ení, obsah, literatura nebo pøílohy se do rozsahu práce nepoèítají. Je proto nutné nejdøíve oznaèit jádro práce a~teprve pak si nechat spoèítat poèet znakù. Pøibli¾ný rozsah obrázkù odhadnete ruènì. Podobnì lze postupovat i~pøi pou¾ití OpenOffice. Pøi pou¾ití systému LaTeX pro sazbu je situace trochu slo¾itìj¹í. Pro hrubý odhad poètu normostran lze vyu¾ít souèet velikostí zdrojových souborù práce podìlený konstantou cca 2000 (normálnì bychom dìlili konstantou 1800, jen¾e ve zdrojových souborech jsou i~vyznaèovací pøíkazy, které se do rozsahu nepoèítají). Pro pøesnìj¹í odhad lze pak vyextrahovat holý text z~PDF (napø. metodou cut-and-paste nebo {\it Save as Text...}) a~jeho velikost podìlit konstantou 1800. 


\chapter{Závìr}
Závìreèná kapitola obsahuje zhodnocení dosa¾ených výsledkù se zvlá¹» vyznaèeným vlastním pøínosem studenta. Povinnì se zde objeví i zhodnocení z pohledu dal¹ího vývoje projektu, student uvede námìty vycházející ze zku¹eností s øe¹eným projektem a uvede rovnì¾ návaznosti na právì dokonèené projekty.

%=========================================================================
